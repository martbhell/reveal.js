<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Yubikeys & You</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<section>
						This slideset is made using <a href="https://github.com/hakimel/reveal.js/" target="_blank">reveal.js</a>.
<br />

You can change slides with the *arrow keys*.
<br />

You can get an overview of all the slides by pressing *esc*.
<br />

Press **↓** to see an index of topics.
<br />
Press **→** one or more times to select topic.

					</section>
					<section data-background="topic_background.png" data-background-size="contain">
						<br />Yubikeys for<br />SSH keys <br /> <font size="+2">2019 <br /> Johan Guldmyr & CSC Pouta Cloud Team</font>
					</section>
					<section>
						Credits to CSC Pouta Team, Kalle and Uppsala Uppmax HPC Team

					</section>
					<section>
						Documentation: <br />
						<a href="http://www.9bitwizard.eu/yubikey-ibikey-letsallbikey"> http://www.9bitwizard.eu/yubikey-ibikey-letsallbikey </a> <br />
						For using it with Ubuntu<br />

						<a href="https://wiki.csc.fi/CloudComputing/YubiKey"> Internal CSC Wiki CloudComputing Yubikeys </a> <br />
					</section>
					<section data-background="yubi_plugged.JPG" data-background-size="contain">
					</section>
					<section data-background="yubi_out.JPG" data-background-size="contain">
					</section>
					<section>

<ol>
  <li>get a yubikey</li>
  <li>install some software (opensc, yubico-piv-tool)</li>
  <li> run some yubico-piv-tool commands to:</li>
  <ol>
    <li>set PIN (max 8 chars, not only numbers) & PUK (super long)</li>
    <li>generate a private key <i>which cannot leave the yubikey </i></li>
    <li>make a certificate</li>
    <li>export public key</li>
  </ol>
  <li>ssh-add -s /usr/lib64/opensc-pkcs11.so</li>
  <li>ssh-keygen -D /usr/lib64/opensc-pkcs11.so -e</li>
  <li>ssh myuser@server.example.com</li>
</ol>

					</section>
					<section>
						<h3>yubikey4: </h3>
						Secure Static Passwords, Yubico OTP, OATH – HOTP (Event), OATH – TOTP (Time), Smart Card (PIV-Compatible), OpenPGP, FIDO U2F <br /><br />
						<h3>yubikey5 (released 2018) </h3>
						Also FIDO2, NFC
					</section>
					<section>
						<b>Random thoughts 1/2:</b> <br /> <br />

Best would be to get one when starting at CSC. No need to remember all the places where the key needs to manually be placed (hello central ssh key management). Who owns the device?<br /><br />

One can also use yubikey for other things (two factor auth to login to <a href="https://support.yubico.com/support/solutions/articles/15000006469-using-your-yubikey-with-github">github</a> for example) <br /> <br />
					</section>
					<section>

						<b>Random thoughts 2/2:</b> <br /> <br />
smartcard , challenge-reponse, static long password, one-time passwords, gnome-keyring, PGP<br /> <br />

Only RSA 2048 in the "PIV" slot in the Yubikey 4. It supports 4096 RSA PGP keys.  <br /><br />

Needs a USB slot, One USB 3.0 hub from Fujitech tried - did not work. <br /><br />

Store PIN & PUK somewhere.
					</section>
					<section>
						<b>Random thoughts 3/3:</b> <br /> <br />
						Could not add key back to agent after reinserting:<br />
						<pre>$ ssh-add -s pkcs11
Enter passphrase for PKCS#11: 
Could not add card "pkcs11": agent refused operation
						</pre>
.. Try taking out and and in again a few times.<br /><br />

Also maybe these can help: Setup udev rules to remove from agent when physically removed?<br />
"ssh-add -L; "ssh-add -D; lsusb". For MacOS maybe google "USB not working after sleep mode"
					</section>
				</section>
				
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
